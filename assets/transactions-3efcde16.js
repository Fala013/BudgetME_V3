import{r as x,u as f,g as y,s as m,j as e}from"./auth-9b7fb0b9.js";const h=()=>{const[n,l]=x.useState([]),{user:r}=f();x.useEffect(()=>{r&&c()},[r]);const c=async()=>{const t=await y(r.uid);l(t)},s=async t=>{const i=Date.now().toString(),o={id:i,...t,userId:r.uid};if(t.type==="trasferimento"){const d=i,p={...o,id:`${d}_out`,transferId:d,amount:-Math.abs(t.amount)},g={...o,id:`${d}_in`,transferId:d,amount:Math.abs(t.amount)};await m(r.uid,p),await m(r.uid,g)}else await m(r.uid,o);await c()},a=async(t,i)=>{const o=n.find(d=>d.id===t);if(o){if(o.transferId||t.toString().endsWith("_in")||t.toString().endsWith("_out")){const d=o.transferId||t.toString().replace("_in","").replace("_out",""),p={...i,id:`${d}_out`,transferId:d,amount:-Math.abs(i.amount)},g={...i,id:`${d}_in`,transferId:d,amount:Math.abs(i.amount)};await m(r.uid,p),await m(r.uid,g)}else await m(r.uid,{...i,id:t,userId:r.uid});await c()}},u=async t=>{const i=n.find(o=>o.id===t);i&&(i.transferId||t.toString().endsWith("_in")||t.toString().endsWith("_out")?(i.transferId||t.toString().replace("_in","").replace("_out",""),await u(r.uid),await u(r.uid)):await u(r.uid),await c())};return{transactions:n,addTransaction:s,updateTransaction:a,deleteTransaction:u}},w=({transaction:n,onClose:l})=>{const{addTransaction:r,updateTransaction:c}=h(),[s,a]=x.useState({type:"entrata",amount:"",description:"",category:"",date:new Date().toISOString().split("T")[0],account:""});x.useEffect(()=>{n&&a({type:n.type,amount:Math.abs(n.amount).toString(),description:n.description,category:n.category,date:n.date,account:n.account})},[n]);const u=async t=>{t.preventDefault();const i=parseFloat(s.amount);if(isNaN(i)||i<=0)return;const o={...s,amount:s.type==="entrata"?i:-i,date:s.date};n?await c(n.id,o):await r(o),l()};return e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tipo"}),e.jsxs("select",{value:s.type,onChange:t=>a({...s,type:t.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[e.jsx("option",{value:"entrata",children:"Entrata"}),e.jsx("option",{value:"uscita",children:"Uscita"}),e.jsx("option",{value:"trasferimento",children:"Trasferimento"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Importo"}),e.jsx("input",{type:"number",step:"0.01",value:s.amount,onChange:t=>a({...s,amount:t.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Descrizione"}),e.jsx("input",{type:"text",value:s.description,onChange:t=>a({...s,description:t.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Categoria"}),e.jsx("input",{type:"text",value:s.category,onChange:t=>a({...s,category:t.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Data"}),e.jsx("input",{type:"date",value:s.date,onChange:t=>a({...s,date:t.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Conto"}),e.jsx("input",{type:"text",value:s.account,onChange:t=>a({...s,account:t.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Annulla"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md hover:bg-indigo-700",children:n?"Modifica":"Aggiungi"})]})]})},j=({onEdit:n})=>{const{transactions:l,deleteTransaction:r}=h(),c=a=>new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(a),s=a=>new Date(a).toLocaleDateString("it-IT");return e.jsxs("div",{className:"mt-4",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Transazioni"}),e.jsx("div",{className:"mt-2 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Descrizione"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Categoria"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Conto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Importo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Azioni"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s(a.date)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.description}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.category}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.account}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("span",{className:`${a.amount>=0?"text-green-600":"text-red-600"}`,children:c(a.amount)})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.jsx("button",{onClick:()=>n(a),className:"text-indigo-600 hover:text-indigo-900 mr-4",children:"Modifica"}),e.jsx("button",{onClick:()=>r(a.id),className:"text-red-600 hover:text-red-900",children:"Elimina"})]})]},a.id))})]})})]})};export{w as T,j as a};
